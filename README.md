Adjustable-strength Floy-Steinberg dithering of RGB image constrained to a palette, C#

Palette specified via bitmap image, all colors in the image are registered as the palette.
